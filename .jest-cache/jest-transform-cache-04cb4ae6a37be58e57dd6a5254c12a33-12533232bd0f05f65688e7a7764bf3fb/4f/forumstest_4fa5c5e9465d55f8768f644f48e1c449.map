{"version":3,"sources":["D:\\Tech Vitta\\Apps\\DEMO\\__tests__\\pages\\forums.test.js"],"sourcesContent":["/**\r\n * Forums Page Tests\r\n * Tests for Forums feature functionality\r\n */\r\n\r\nimport { render, screen, fireEvent, waitFor } from '@testing-library/react';\r\nimport { useRouter, useSearchParams } from 'next/navigation';\r\nimport ForumsPage from '@/app/forums/page';\r\nimport { getCurrentUser } from '@/lib/localStorage';\r\nimport { showToast } from '@/utils/helpers';\r\n\r\n// Mock dependencies\r\njest.mock('next/navigation', () => ({\r\n  useRouter: jest.fn(),\r\n  useSearchParams: jest.fn(() => new URLSearchParams()),\r\n  usePathname: jest.fn(() => '/forums'),\r\n}));\r\njest.mock('@/lib/localStorage');\r\njest.mock('@/utils/helpers');\r\njest.mock('@/components/ui/Card', () => {\r\n  return function Card({ children, className, onClick }) {\r\n    return <div className={className} onClick={onClick} data-testid=\"card\">{children}</div>;\r\n  };\r\n});\r\njest.mock('@/components/ui/Button', () => {\r\n  return function Button({ children, onClick, disabled, className, variant }) {\r\n    return <button onClick={onClick} disabled={disabled} className={className} data-testid=\"button\">{children}</button>;\r\n  };\r\n});\r\njest.mock('@/components/ui/Input', () => {\r\n  return function Input({ placeholder, value, onChange, className }) {\r\n    return <input placeholder={placeholder} value={value} onChange={onChange} className={className} data-testid=\"input\" />;\r\n  };\r\n});\r\n\r\nconst mockPush = jest.fn();\r\nconst mockRouter = {\r\n  push: mockPush,\r\n  back: jest.fn(),\r\n  replace: jest.fn(),\r\n};\r\n\r\nconst mockSearchParams = {\r\n  get: jest.fn(),\r\n};\r\n\r\nconst mockUser = {\r\n  id: 'user1',\r\n  name: 'Test User',\r\n  email: 'test@example.com',\r\n};\r\n\r\ndescribe('Forums Page', () => {\r\n  beforeEach(() => {\r\n    jest.clearAllMocks();\r\n    mockPush.mockClear();\r\n    useRouter.mockReturnValue(mockRouter);\r\n    useSearchParams.mockReturnValue(mockSearchParams);\r\n    getCurrentUser.mockReturnValue(mockUser);\r\n    showToast.mockImplementation(() => {});\r\n    mockSearchParams.get.mockReturnValue(null);\r\n    \r\n    // Reset localStorage mock\r\n    if (typeof window !== 'undefined' && window.localStorage) {\r\n      window.localStorage.clear();\r\n    }\r\n  });\r\n\r\n  it('renders forums page with header', async () => {\r\n    render(<ForumsPage />);\r\n    await waitFor(() => {\r\n      expect(screen.getByText(/Community Forums/i)).toBeInTheDocument();\r\n    }, { timeout: 3000 });\r\n  });\r\n\r\n  it('displays search input', async () => {\r\n    render(<ForumsPage />);\r\n    await waitFor(() => {\r\n      const searchInput = screen.getByPlaceholderText(/Search forums/i);\r\n      expect(searchInput).toBeInTheDocument();\r\n    }, { timeout: 3000 });\r\n  });\r\n\r\n  it('displays category filter buttons', async () => {\r\n    render(<ForumsPage />);\r\n    await waitFor(() => {\r\n      expect(screen.getByText(/All/i)).toBeInTheDocument();\r\n      expect(screen.getByText(/Success Stories/i)).toBeInTheDocument();\r\n    }, { timeout: 3000 });\r\n  });\r\n\r\n  it('filters forums by category', async () => {\r\n    render(<ForumsPage />);\r\n    \r\n    await waitFor(() => {\r\n      const categoryButton = screen.getByText(/Success Stories/i);\r\n      fireEvent.click(categoryButton);\r\n      expect(categoryButton).toBeInTheDocument();\r\n    });\r\n  });\r\n\r\n  it('navigates to forum detail when forum card clicked', async () => {\r\n    render(<ForumsPage />);\r\n    \r\n    await waitFor(() => {\r\n      const forumCards = screen.queryAllByText(/Success Stories|Dating Tips/i);\r\n      if (forumCards.length > 0) {\r\n        fireEvent.click(forumCards[0].closest('[class*=\"cursor-pointer\"]'));\r\n        expect(mockPush).toHaveBeenCalled();\r\n      }\r\n    });\r\n  });\r\n\r\n  it('displays posts when forum is selected', async () => {\r\n    mockSearchParams.get.mockReturnValue('1');\r\n    \r\n    render(<ForumsPage />);\r\n    \r\n    await waitFor(() => {\r\n      const backButton = screen.queryByText(/Back to Forums/i);\r\n      expect(backButton || screen.getByText(/Community Forums/i)).toBeTruthy();\r\n    });\r\n  });\r\n\r\n  it('handles create post button click', async () => {\r\n    mockSearchParams.get.mockReturnValue('1');\r\n    \r\n    render(<ForumsPage />);\r\n    \r\n    await waitFor(() => {\r\n      const createButton = screen.queryByText(/Create New Post/i);\r\n      if (createButton) {\r\n        fireEvent.click(createButton);\r\n        expect(mockPush).toHaveBeenCalledWith(expect.stringContaining('/forums/create-post'));\r\n      }\r\n    });\r\n  });\r\n\r\n  it('handles sort option change', async () => {\r\n    mockSearchParams.get.mockReturnValue('1');\r\n    \r\n    render(<ForumsPage />);\r\n    \r\n    await waitFor(() => {\r\n      const sortButtons = screen.queryAllByText(/Recent|Popular|Trending/i);\r\n      if (sortButtons.length > 0) {\r\n        fireEvent.click(sortButtons[0]);\r\n        expect(sortButtons[0]).toBeInTheDocument();\r\n      }\r\n    });\r\n  });\r\n\r\n  it('displays pagination controls', async () => {\r\n    render(<ForumsPage />);\r\n    \r\n    await waitFor(() => {\r\n      const paginationButtons = screen.queryAllByText(/Previous|Next/i);\r\n      // Pagination may or may not appear\r\n      expect(paginationButtons.length).toBeGreaterThanOrEqual(0);\r\n    });\r\n  });\r\n\r\n  it('handles empty forums array gracefully', async () => {\r\n    getCurrentUser.mockReturnValue(mockUser);\r\n    render(<ForumsPage />);\r\n    \r\n    await waitFor(() => {\r\n      expect(screen.getByText(/Community Forums/i)).toBeInTheDocument();\r\n    });\r\n  });\r\n\r\n  it('redirects to login if user not authenticated', () => {\r\n    getCurrentUser.mockReturnValue(null);\r\n    render(<ForumsPage />);\r\n    \r\n    expect(mockPush).toHaveBeenCalledWith('/login');\r\n  });\r\n\r\n  it('handles back to forums navigation', async () => {\r\n    mockSearchParams.get.mockReturnValue('1');\r\n    \r\n    render(<ForumsPage />);\r\n    \r\n    await waitFor(() => {\r\n      const backButton = screen.queryByText(/Back to Forums/i);\r\n      if (backButton) {\r\n        fireEvent.click(backButton);\r\n        expect(mockPush).toHaveBeenCalledWith('/forums');\r\n      }\r\n    });\r\n  });\r\n\r\n  it('filters posts by search query', async () => {\r\n    mockSearchParams.get.mockReturnValue('1');\r\n    \r\n    render(<ForumsPage />);\r\n    \r\n    await waitFor(() => {\r\n      const searchInput = screen.queryByPlaceholderText(/Search posts/i);\r\n      if (searchInput) {\r\n        fireEvent.change(searchInput, { target: { value: 'test' } });\r\n        expect(searchInput.value).toBe('test');\r\n      }\r\n    });\r\n  });\r\n});\r\n\r\n"],"names":["jest","mock","useRouter","fn","useSearchParams","URLSearchParams","usePathname","Card","children","className","onClick","div","data-testid","Button","disabled","variant","button","Input","placeholder","value","onChange","input","mockPush","mockRouter","push","back","replace","mockSearchParams","get","mockUser","id","name","email","describe","beforeEach","clearAllMocks","mockClear","mockReturnValue","getCurrentUser","showToast","mockImplementation","window","localStorage","clear","it","render","ForumsPage","waitFor","expect","screen","getByText","toBeInTheDocument","timeout","searchInput","getByPlaceholderText","categoryButton","fireEvent","click","forumCards","queryAllByText","length","closest","toHaveBeenCalled","backButton","queryByText","toBeTruthy","createButton","toHaveBeenCalledWith","stringContaining","sortButtons","paginationButtons","toBeGreaterThanOrEqual","queryByPlaceholderText","change","target","toBe"],"mappings":"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"}