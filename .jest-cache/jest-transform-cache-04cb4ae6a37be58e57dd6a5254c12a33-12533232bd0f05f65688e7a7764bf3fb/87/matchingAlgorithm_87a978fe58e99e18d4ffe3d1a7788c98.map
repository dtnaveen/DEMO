{"version":3,"sources":["D:\\Tech Vitta\\Apps\\DEMO\\lib\\matchingAlgorithm.js"],"sourcesContent":["import { VALUE_QUESTIONS, CONTENT_QUESTIONS } from './constants';\r\n\r\n/**\r\n * AI-Powered Matching Algorithm\r\n * Enhanced with machine learning-inspired scoring\r\n */\r\n\r\n/**\r\n * Calculate match score between two users using AI-powered algorithm\r\n * @param {Object} user1 - First user object\r\n * @param {Object} user2 - Second user object\r\n * @returns {Object} Match score breakdown\r\n */\r\nexport function calculateMatchScore(user1, user2) {\r\n  // If both users have no value answers, return 0% match\r\n  if ((!user1.valueAnswers || user1.valueAnswers.length === 0) && \r\n      (!user2.valueAnswers || user2.valueAnswers.length === 0)) {\r\n    return {\r\n      totalScore: 0,\r\n      percentage: 0,\r\n      valuesScore: 0,\r\n      contentScore: 0,\r\n      lifestyleScore: 0,\r\n      educationScore: 0,\r\n      lifestyleMatchScore: 0,\r\n      socialScore: 0,\r\n      verificationScore: 0,\r\n      activityScore: 0,\r\n      breakdown: {\r\n        values: 0,\r\n        content: 0,\r\n        lifestyle: 0,\r\n        education: 0,\r\n        social: 0\r\n      }\r\n    };\r\n  }\r\n\r\n  // Values score (40% - 80 points max) - Reduced from 50% to make room for new factors\r\n  let valuesScore = 0;\r\n  if (user1.valueAnswers && user2.valueAnswers) {\r\n    for (let i = 0; i < Math.min(user1.valueAnswers.length, user2.valueAnswers.length, 10); i++) {\r\n      const answer1 = user1.valueAnswers[i];\r\n      const answer2 = user2.valueAnswers[i];\r\n      \r\n      if (answer1 === answer2) {\r\n        valuesScore += 8; // Exact match (reduced from 10)\r\n      } else if (answer1 !== undefined && answer2 !== undefined) {\r\n        const diff = Math.abs(answer1 - answer2);\r\n        if (diff === 1) {\r\n          valuesScore += 4; // Adjacent answer (reduced from 5)\r\n        } else if (diff === 2) {\r\n          valuesScore += 1; // Slight compatibility\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  // Content score (25% - 50 points max)\r\n  let contentScore = 0;\r\n  if (user1.contentAnswers && user2.contentAnswers && user1.ageGroup === user2.ageGroup) {\r\n    const maxLength = Math.min(user1.contentAnswers.length, user2.contentAnswers.length, 5);\r\n    for (let i = 0; i < maxLength; i++) {\r\n      if (user1.contentAnswers[i] === user2.contentAnswers[i]) {\r\n        contentScore += 10; // Each matching preference = 10 points\r\n      }\r\n    }\r\n  } else if (user1.ageGroup !== user2.ageGroup) {\r\n    contentScore = 10; // Base score for different age groups\r\n  }\r\n\r\n  // Lifestyle compatibility (20% - 40 points max)\r\n  let lifestyleScore = 0;\r\n  \r\n  // Based on Friday night preference (social energy)\r\n  if (user1.valueAnswers && user2.valueAnswers && user1.valueAnswers[0] !== undefined && user2.valueAnswers[0] !== undefined) {\r\n    const fridayNightDiff = Math.abs(user1.valueAnswers[0] - user2.valueAnswers[0]);\r\n    if (fridayNightDiff === 0) {\r\n      lifestyleScore += 15; // Same energy level\r\n    } else if (fridayNightDiff === 1) {\r\n      lifestyleScore += 8; // Somewhat compatible\r\n    }\r\n  }\r\n\r\n  // Based on recharge preference\r\n  if (user1.valueAnswers && user2.valueAnswers && user1.valueAnswers[4] !== undefined && user2.valueAnswers[4] !== undefined) {\r\n    const rechargeDiff = Math.abs(user1.valueAnswers[4] - user2.valueAnswers[4]);\r\n    if (rechargeDiff === 0) {\r\n      lifestyleScore += 15;\r\n    } else if (rechargeDiff === 1) {\r\n      lifestyleScore += 7;\r\n    }\r\n  }\r\n\r\n  // NEW: Education compatibility (5% - 10 points max)\r\n  let educationScore = 0;\r\n  if (user1.education && user2.education) {\r\n    const educationLevels = ['High School', 'Some College', \"Bachelor's Degree\", \"Master's Degree\", 'PhD'];\r\n    const level1 = educationLevels.indexOf(user1.education);\r\n    const level2 = educationLevels.indexOf(user2.education);\r\n    if (level1 >= 0 && level2 >= 0) {\r\n      const diff = Math.abs(level1 - level2);\r\n      if (diff === 0) {\r\n        educationScore = 10; // Same level\r\n      } else if (diff === 1) {\r\n        educationScore = 5; // Similar level\r\n      }\r\n    } else if (user1.education === user2.education) {\r\n      educationScore = 10;\r\n    }\r\n  }\r\n\r\n  // NEW: Lifestyle compatibility (5% - 10 points max)\r\n  let lifestyleMatchScore = 0;\r\n  if (user1.lifestyle && user2.lifestyle) {\r\n    // Exercise compatibility\r\n    if (user1.lifestyle.exercise && user2.lifestyle.exercise) {\r\n      if (user1.lifestyle.exercise === user2.lifestyle.exercise) {\r\n        lifestyleMatchScore += 3;\r\n      }\r\n    }\r\n    // Diet compatibility\r\n    if (user1.lifestyle.diet && user2.lifestyle.diet) {\r\n      if (user1.lifestyle.diet === user2.lifestyle.diet) {\r\n        lifestyleMatchScore += 3;\r\n      }\r\n    }\r\n    // Drinking compatibility\r\n    if (user1.lifestyle.drinking && user2.lifestyle.drinking) {\r\n      const drinkingLevels = ['Never', 'Rarely', 'Socially', 'Regularly'];\r\n      const level1 = drinkingLevels.indexOf(user1.lifestyle.drinking);\r\n      const level2 = drinkingLevels.indexOf(user2.lifestyle.drinking);\r\n      if (level1 >= 0 && level2 >= 0) {\r\n        const diff = Math.abs(level1 - level2);\r\n        if (diff <= 1) {\r\n          lifestyleMatchScore += 2;\r\n        }\r\n      }\r\n    }\r\n    // Children compatibility\r\n    if (user1.lifestyle.children && user2.lifestyle.children) {\r\n      if (user1.lifestyle.children === user2.lifestyle.children) {\r\n        lifestyleMatchScore += 2;\r\n      }\r\n    }\r\n  }\r\n\r\n  // NEW: Social media compatibility (2% - 4 points max)\r\n  let socialScore = 0;\r\n  if (user1.socialMedia && user2.socialMedia) {\r\n    if (user1.socialMedia.instagram && user2.socialMedia.instagram) {\r\n      socialScore += 1;\r\n    }\r\n    if (user1.socialMedia.spotify && user2.socialMedia.spotify) {\r\n      socialScore += 1;\r\n    }\r\n    // Check for shared interests from social media\r\n    if (user1.socialMedia.interests && user2.socialMedia.interests) {\r\n      const shared = user1.socialMedia.interests.filter(i => \r\n        user2.socialMedia.interests.includes(i)\r\n      );\r\n      socialScore += Math.min(shared.length, 2);\r\n    }\r\n  }\r\n\r\n  // NEW: Photo verification bonus (1% - 2 points max)\r\n  let verificationScore = 0;\r\n  if (user1.verified && user2.verified) {\r\n    verificationScore = 2; // Both verified = trust bonus\r\n  } else if (user1.verified || user2.verified) {\r\n    verificationScore = 1; // One verified = slight bonus\r\n  }\r\n\r\n  // NEW: Activity/engagement score (2% - 4 points max)\r\n  let activityScore = 0;\r\n  if (user1.lastActive && user2.lastActive) {\r\n    const daysSinceActive1 = (Date.now() - new Date(user1.lastActive).getTime()) / (1000 * 60 * 60 * 24);\r\n    const daysSinceActive2 = (Date.now() - new Date(user2.lastActive).getTime()) / (1000 * 60 * 60 * 24);\r\n    // Both active recently = bonus\r\n    if (daysSinceActive1 < 7 && daysSinceActive2 < 7) {\r\n      activityScore = 4;\r\n    } else if (daysSinceActive1 < 30 && daysSinceActive2 < 30) {\r\n      activityScore = 2;\r\n    }\r\n  }\r\n\r\n  const totalScore = valuesScore + contentScore + lifestyleScore + educationScore + \r\n                     lifestyleMatchScore + socialScore + verificationScore + activityScore;\r\n  const maxScore = 200; // Increased from 150\r\n  const percentage = Math.min(100, Math.round((totalScore / maxScore) * 100));\r\n\r\n  return {\r\n    totalScore,\r\n    percentage,\r\n    valuesScore,\r\n    contentScore,\r\n    lifestyleScore,\r\n    educationScore,\r\n    lifestyleMatchScore,\r\n    socialScore,\r\n    verificationScore,\r\n    activityScore,\r\n    breakdown: {\r\n      values: Math.round((valuesScore / 80) * 40),\r\n      content: Math.round((contentScore / 50) * 25),\r\n      lifestyle: Math.round(((lifestyleScore + lifestyleMatchScore) / 50) * 25),\r\n      education: Math.round((educationScore / 10) * 5),\r\n      social: Math.round(((socialScore + verificationScore + activityScore) / 10) * 5)\r\n    }\r\n  };\r\n}\r\n\r\n/**\r\n * Get shared interests/values between two users\r\n */\r\nexport function getSharedInterests(user1, user2) {\r\n  const shared = [];\r\n  \r\n  if (user1.valueAnswers && user2.valueAnswers && VALUE_QUESTIONS) {\r\n    for (let i = 0; i < Math.min(user1.valueAnswers.length, user2.valueAnswers.length, VALUE_QUESTIONS.length); i++) {\r\n      if (user1.valueAnswers[i] === user2.valueAnswers[i]) {\r\n        const question = VALUE_QUESTIONS[i];\r\n        if (question && question.options) {\r\n          shared.push({\r\n            question: question.question,\r\n            answer: question.options[user1.valueAnswers[i]]\r\n          });\r\n        }\r\n      }\r\n    }\r\n  }\r\n  \r\n  return shared.slice(0, 3); // Return top 3\r\n}\r\n\r\n/**\r\n * Get shared content preferences\r\n */\r\nexport function getSharedContent(user1, user2) {\r\n  const shared = [];\r\n  \r\n  if (user1.ageGroup === user2.ageGroup && user1.contentAnswers && user2.contentAnswers) {\r\n    const contentQuestions = CONTENT_QUESTIONS[user1.ageGroup];\r\n    if (contentQuestions) {\r\n      for (let i = 0; i < Math.min(user1.contentAnswers.length, user2.contentAnswers.length, contentQuestions.length); i++) {\r\n        if (user1.contentAnswers[i] === user2.contentAnswers[i]) {\r\n          shared.push({\r\n            question: contentQuestions[i].question,\r\n            answer: contentQuestions[i].options[user1.contentAnswers[i]]\r\n          });\r\n        }\r\n      }\r\n    }\r\n  }\r\n  \r\n  return shared;\r\n}\r\n"],"names":["calculateMatchScore","getSharedContent","getSharedInterests","user1","user2","valueAnswers","length","totalScore","percentage","valuesScore","contentScore","lifestyleScore","educationScore","lifestyleMatchScore","socialScore","verificationScore","activityScore","breakdown","values","content","lifestyle","education","social","i","Math","min","answer1","answer2","undefined","diff","abs","contentAnswers","ageGroup","maxLength","fridayNightDiff","rechargeDiff","educationLevels","level1","indexOf","level2","exercise","diet","drinking","drinkingLevels","children","socialMedia","instagram","spotify","interests","shared","filter","includes","verified","lastActive","daysSinceActive1","Date","now","getTime","daysSinceActive2","maxScore","round","VALUE_QUESTIONS","question","options","push","answer","slice","contentQuestions","CONTENT_QUESTIONS"],"mappings":"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"}