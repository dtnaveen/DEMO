{"version":3,"sources":["D:\\Tech Vitta\\Apps\\DEMO\\__tests__\\lib\\localStorage.test.js"],"sourcesContent":["import {\r\n  getCurrentUser,\r\n  setCurrentUser,\r\n  getAllUsers,\r\n  getConversations,\r\n} from '@/lib/localStorage'\r\n\r\n// Mock localStorage\r\nlet store = {};\r\nconst localStorageMock = {\r\n  getItem: jest.fn((key) => {\r\n    return store[key] || null;\r\n  }),\r\n  setItem: jest.fn((key, value) => {\r\n    store[key] = value.toString();\r\n  }),\r\n  removeItem: jest.fn((key) => {\r\n    delete store[key];\r\n  }),\r\n  clear: jest.fn(() => {\r\n    store = {};\r\n  })\r\n};\r\n\r\n// Ensure window exists before any tests\r\nif (typeof window === 'undefined') {\r\n  global.window = {};\r\n}\r\n\r\n// Set up localStorage before any imports or tests run\r\nObject.defineProperty(window, 'localStorage', {\r\n  value: localStorageMock,\r\n  writable: true,\r\n  configurable: true,\r\n});\r\nglobal.localStorage = localStorageMock;\r\n\r\nbeforeEach(() => {\r\n  // Reset the store\r\n  store = {};\r\n  \r\n  // Re-create mock implementations (Jest's resetMocks might clear them)\r\n  localStorageMock.getItem.mockImplementation((key) => {\r\n    return store[key] || null;\r\n  });\r\n  localStorageMock.setItem.mockImplementation((key, value) => {\r\n    store[key] = value.toString();\r\n  });\r\n  localStorageMock.removeItem.mockImplementation((key) => {\r\n    delete store[key];\r\n  });\r\n  localStorageMock.clear.mockImplementation(() => {\r\n    store = {};\r\n  });\r\n  \r\n  // Re-setup localStorage to ensure it's fresh\r\n  Object.defineProperty(window, 'localStorage', {\r\n    value: localStorageMock,\r\n    writable: true,\r\n    configurable: true,\r\n  });\r\n  global.localStorage = localStorageMock;\r\n})\r\n\r\ndescribe('localStorage functions', () => {\r\n  describe('getCurrentUser', () => {\r\n    it('returns null when no user is stored', () => {\r\n      expect(getCurrentUser()).toBeNull()\r\n    })\r\n\r\n    it('returns user when user is stored', () => {\r\n      const user = { id: '1', name: 'Test User' }\r\n      localStorageMock.setItem('currentUser', JSON.stringify(user))\r\n      expect(getCurrentUser()).toEqual(user)\r\n    })\r\n  })\r\n\r\n  describe('setCurrentUser', () => {\r\n    it('saves user to localStorage', () => {\r\n      const user = { id: '1', name: 'Test User' }\r\n      setCurrentUser(user)\r\n      expect(localStorageMock.setItem).toHaveBeenCalledWith(\r\n        'currentUser',\r\n        JSON.stringify(user)\r\n      )\r\n    })\r\n  })\r\n\r\n  describe('getAllUsers', () => {\r\n    it('returns empty array when no users are stored', () => {\r\n      expect(getAllUsers()).toEqual([])\r\n    })\r\n\r\n    it('returns users when users are stored', () => {\r\n      const users = [{ id: '1', name: 'User 1' }, { id: '2', name: 'User 2' }]\r\n      localStorageMock.setItem('allUsers', JSON.stringify(users))\r\n      expect(getAllUsers()).toEqual(users)\r\n    })\r\n  })\r\n})\r\n\r\n"],"names":["store","localStorageMock","getItem","jest","fn","key","setItem","value","toString","removeItem","clear","window","global","Object","defineProperty","writable","configurable","localStorage","beforeEach","mockImplementation","describe","it","expect","getCurrentUser","toBeNull","user","id","name","JSON","stringify","toEqual","setCurrentUser","toHaveBeenCalledWith","getAllUsers","users"],"mappings":";;;;8BAKO;AAEP,oBAAoB;AACpB,IAAIA,QAAQ,CAAC;AACb,MAAMC,mBAAmB;IACvBC,SAASC,KAAKC,EAAE,CAAC,CAACC;QAChB,OAAOL,KAAK,CAACK,IAAI,IAAI;IACvB;IACAC,SAASH,KAAKC,EAAE,CAAC,CAACC,KAAKE;QACrBP,KAAK,CAACK,IAAI,GAAGE,MAAMC,QAAQ;IAC7B;IACAC,YAAYN,KAAKC,EAAE,CAAC,CAACC;QACnB,OAAOL,KAAK,CAACK,IAAI;IACnB;IACAK,OAAOP,KAAKC,EAAE,CAAC;QACbJ,QAAQ,CAAC;IACX;AACF;AAEA,wCAAwC;AACxC,IAAI,OAAOW,WAAW,aAAa;IACjCC,OAAOD,MAAM,GAAG,CAAC;AACnB;AAEA,sDAAsD;AACtDE,OAAOC,cAAc,CAACH,QAAQ,gBAAgB;IAC5CJ,OAAON;IACPc,UAAU;IACVC,cAAc;AAChB;AACAJ,OAAOK,YAAY,GAAGhB;AAEtBiB,WAAW;IACT,kBAAkB;IAClBlB,QAAQ,CAAC;IAET,sEAAsE;IACtEC,iBAAiBC,OAAO,CAACiB,kBAAkB,CAAC,CAACd;QAC3C,OAAOL,KAAK,CAACK,IAAI,IAAI;IACvB;IACAJ,iBAAiBK,OAAO,CAACa,kBAAkB,CAAC,CAACd,KAAKE;QAChDP,KAAK,CAACK,IAAI,GAAGE,MAAMC,QAAQ;IAC7B;IACAP,iBAAiBQ,UAAU,CAACU,kBAAkB,CAAC,CAACd;QAC9C,OAAOL,KAAK,CAACK,IAAI;IACnB;IACAJ,iBAAiBS,KAAK,CAACS,kBAAkB,CAAC;QACxCnB,QAAQ,CAAC;IACX;IAEA,6CAA6C;IAC7Ca,OAAOC,cAAc,CAACH,QAAQ,gBAAgB;QAC5CJ,OAAON;QACPc,UAAU;QACVC,cAAc;IAChB;IACAJ,OAAOK,YAAY,GAAGhB;AACxB;AAEAmB,SAAS,0BAA0B;IACjCA,SAAS,kBAAkB;QACzBC,GAAG,uCAAuC;YACxCC,OAAOC,IAAAA,4BAAc,KAAIC,QAAQ;QACnC;QAEAH,GAAG,oCAAoC;YACrC,MAAMI,OAAO;gBAAEC,IAAI;gBAAKC,MAAM;YAAY;YAC1C1B,iBAAiBK,OAAO,CAAC,eAAesB,KAAKC,SAAS,CAACJ;YACvDH,OAAOC,IAAAA,4BAAc,KAAIO,OAAO,CAACL;QACnC;IACF;IAEAL,SAAS,kBAAkB;QACzBC,GAAG,8BAA8B;YAC/B,MAAMI,OAAO;gBAAEC,IAAI;gBAAKC,MAAM;YAAY;YAC1CI,IAAAA,4BAAc,EAACN;YACfH,OAAOrB,iBAAiBK,OAAO,EAAE0B,oBAAoB,CACnD,eACAJ,KAAKC,SAAS,CAACJ;QAEnB;IACF;IAEAL,SAAS,eAAe;QACtBC,GAAG,gDAAgD;YACjDC,OAAOW,IAAAA,yBAAW,KAAIH,OAAO,CAAC,EAAE;QAClC;QAEAT,GAAG,uCAAuC;YACxC,MAAMa,QAAQ;gBAAC;oBAAER,IAAI;oBAAKC,MAAM;gBAAS;gBAAG;oBAAED,IAAI;oBAAKC,MAAM;gBAAS;aAAE;YACxE1B,iBAAiBK,OAAO,CAAC,YAAYsB,KAAKC,SAAS,CAACK;YACpDZ,OAAOW,IAAAA,yBAAW,KAAIH,OAAO,CAACI;QAChC;IACF;AACF"}